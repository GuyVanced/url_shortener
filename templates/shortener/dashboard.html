{% extends "base.html" %}

{% block title %}Dashboard | URL Shortener{% endblock %}

{% block content %}
<style>
    .dashboard-container {
        display: flex;
        min-height: 70vh;
    }

    .sidebar {
        width: 220px;
        border-right: 1px solid #ddd;
        padding: 1rem;
    }

    .sidebar h3 {
        margin-bottom: 1rem;
        font-size: 1.1rem;
    }

    .sidebar a {
        display: block;
        margin-bottom: 0.75rem;
        color: #333;
        font-weight: bold;
    }

    .sidebar a:hover {
        text-decoration: underline;
    }

    .main-content {
        flex: 1;
        padding: 1.5rem;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }

    th, td {
        border-bottom: 1px solid #ddd;
        padding: 0.75rem;
        text-align: left;
    }

    th {
        background-color: #f5f5f5;
    }

    .empty-state {
        margin-top: 2rem;
        color: #666;
    }

    .btn {
        padding: 0.5rem 0.75rem;
        border: 1px solid #333;
        background: #fff;
        cursor: pointer;
        font-size: 0.9rem;
    }

    .btn:hover {
        background: #f0f0f0;
    }
</style>

<div class="dashboard-container">

    <!-- Sidebar -->
    <aside class="sidebar">
        <h3>Menu</h3>
        <a href="{% url 'shortener:dashboard' %}">Dashboard</a>
        <a href="{% url 'shortener:create_short_url' %}">Create Short URL</a>

        <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button class="btn" type="submit">Logout</button>
        </form>
    </aside>

    <!-- Main Content -->
    <section class="main-content">
        <h2>My Short URLs</h2>

        {% if urls %}
            <table>
                <thead>
                    <tr>
                        <th>Short URL</th>
                        <th>Original URL</th>
                        <th>Clicks</th>
                        <th>Created At</th>
                        <th>Expires At</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for url in urls %}
                        <tr>
                            <td>
                                <a href="/{{ url.short_code }}" target="_blank">
                                    {{ request.get_host }}/{{ url.short_code }}
                                </a>
                            </td>
                            <td>{{ url.original_url }}</td>
                            <td>{{ url.click_count }}</td>
                            <td>{{ url.created_at|date:"Y-m-d H:i" }}</td>
                            <td>
                                {% if url.expires_at %}
                                    {{ url.expires_at|date:"Y-m-d H:i" }}
                                {% else %}
                                    Never
                                {% endif %}
                            </td>
                            <td>
                                <a href="{% url 'shortener:delete_short_url' url.id %}">
                                    Delete
                                </a>
                                <a href="{% url 'shortener:edit_url' url.pk %}">
                                    Edit
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="empty-state">
                <p>You haven't created any short URLs yet.</p>
                <a href="{% url 'shortener:create_short_url' %}">
                    <button class="btn">Create your first short URL</button>
                </a>
            </div>
        {% endif %}
    </section>

</div>
{% endblock %}
